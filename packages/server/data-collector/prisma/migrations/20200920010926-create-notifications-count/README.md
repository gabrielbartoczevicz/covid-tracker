# Migration `20200920010926-create-notifications-count`

This migration has been generated by Gabriel Bartoczevicz at 9/19/2020, 10:09:26 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "public"."Status" AS ENUM ('HEALED', 'DISCARTED', 'DEAD')

CREATE TABLE "public"."notifications" (
"id" text   NOT NULL ,
"external_id" text   NOT NULL ,
"notification_date" timestamp(3)   NOT NULL ,
"symptoms" text   ,
"cbo" text   ,
"is_health_professional" boolean   NOT NULL DEFAULT false,
"cnes" text   ,
"state" text   NOT NULL ,
"city" text   NOT NULL ,
"birthday" timestamp(3)   NOT NULL ,
"gender" text   NOT NULL ,
"status_date" timestamp(3)   NOT NULL ,
"status" "Status"  ,
"dateCreated" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."notifications_count" (
"date" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"healed_count" Decimal(65,30)   NOT NULL ,
"discarted_count" Decimal(65,30)   NOT NULL ,
"dead_count" Decimal(65,30)   NOT NULL ,
"notification_count" Decimal(65,30)   NOT NULL 
)

CREATE UNIQUE INDEX "notifications.external_id_unique" ON "public"."notifications"("external_id")

CREATE UNIQUE INDEX "notifications_count.date_unique" ON "public"."notifications_count"("date")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200920010907-create-notifications..20200920010926-create-notifications-count
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -33,4 +33,14 @@
   HEALED
   DISCARTED
   DEAD
 }
+
+model NotificationsCount {
+  date              DateTime @unique @default(now())
+  healedCount       Float    @map("healed_count")
+  discartedCount    Float    @map("discarted_count")
+  deadCount         Float    @map("dead_count")
+  notificationCount Float    @map("notification_count")
+
+  @@map("notifications_count")
+}
```


